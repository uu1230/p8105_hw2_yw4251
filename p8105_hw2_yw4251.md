p8105_hw2_yw4251
================
You Wu
2023-10-01

# Problem 0

``` r
library(tidyverse)
```

    ## ── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
    ## ✔ dplyr     1.1.3     ✔ readr     2.1.4
    ## ✔ forcats   1.0.0     ✔ stringr   1.5.0
    ## ✔ ggplot2   3.4.3     ✔ tibble    3.2.1
    ## ✔ lubridate 1.9.2     ✔ tidyr     1.3.0
    ## ✔ purrr     1.0.2     
    ## ── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
    ## ✖ dplyr::filter() masks stats::filter()
    ## ✖ dplyr::lag()    masks stats::lag()
    ## ℹ Use the conflicted package (<http://conflicted.r-lib.org/>) to force all conflicts to become errors

``` r
library(readxl)
```

# Problem 1

Clean `pols-month.csv`. Apply function`month.name`to replace month
number with month name.

``` r
pols_month_df=
  read_csv("data/pols-month.csv")|>
  separate(mon,into=c("year","month","day"),convert=TRUE)|>
  mutate(
    month=month.name[as.numeric(month)],
    president=recode(prez_gop,"0" = "dem", "1" = "gop", "2" = "gop")
  )|>
  select(-prez_dem,-prez_gop,-day)
```

    ## Rows: 822 Columns: 9
    ## ── Column specification ────────────────────────────────────────────────────────
    ## Delimiter: ","
    ## dbl  (8): prez_gop, gov_gop, sen_gop, rep_gop, prez_dem, gov_dem, sen_dem, r...
    ## date (1): mon
    ## 
    ## ℹ Use `spec()` to retrieve the full column specification for this data.
    ## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.

similarly, clean `snp.csv`

``` r
snp_df=
  read_csv("data/snp.csv")|>
  mutate(date = as.Date(date, format = "%m/%d/%y"))|>
  separate(date,into=c("year","month","day"),convert=TRUE)|>
  arrange(year,month)|>
  mutate(
    month=month.name[as.numeric(month)]
  )|>
  select(year,month,close)
```

    ## Rows: 787 Columns: 2
    ## ── Column specification ────────────────────────────────────────────────────────
    ## Delimiter: ","
    ## chr (1): date
    ## dbl (1): close
    ## 
    ## ℹ Use `spec()` to retrieve the full column specification for this data.
    ## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.

Next, Clean `Unemployment data`.

``` r
unemp_df=
  read_csv('data/unemployment.csv')|>
  pivot_longer(
    Jan:Dec,
    names_to="month",
    values_to="percentage"
  )|>
  rename(year=Year)
```

    ## Rows: 68 Columns: 13
    ## ── Column specification ────────────────────────────────────────────────────────
    ## Delimiter: ","
    ## dbl (13): Year, Jan, Feb, Mar, Apr, May, Jun, Jul, Aug, Sep, Oct, Nov, Dec
    ## 
    ## ℹ Use `spec()` to retrieve the full column specification for this data.
    ## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.

Now merge:

``` r
df=left_join(pols_month_df,snp_df)|>
  mutate(month=substr(month,1,3))|>
  left_join(x= _,unemp_df)
```

    ## Joining with `by = join_by(year, month)`
    ## Joining with `by = join_by(year, month)`

``` r
str(df)
```

    ## tibble [822 × 11] (S3: tbl_df/tbl/data.frame)
    ##  $ year      : num [1:822] 1947 1947 1947 1947 1947 ...
    ##  $ month     : chr [1:822] "Jan" "Feb" "Mar" "Apr" ...
    ##  $ gov_gop   : num [1:822] 23 23 23 23 23 23 23 23 23 23 ...
    ##  $ sen_gop   : num [1:822] 51 51 51 51 51 51 51 51 51 51 ...
    ##  $ rep_gop   : num [1:822] 253 253 253 253 253 253 253 253 253 253 ...
    ##  $ gov_dem   : num [1:822] 23 23 23 23 23 23 23 23 23 23 ...
    ##  $ sen_dem   : num [1:822] 45 45 45 45 45 45 45 45 45 45 ...
    ##  $ rep_dem   : num [1:822] 198 198 198 198 198 198 198 198 198 198 ...
    ##  $ president : chr [1:822] "dem" "dem" "dem" "dem" ...
    ##  $ close     : num [1:822] NA NA NA NA NA NA NA NA NA NA ...
    ##  $ percentage: num [1:822] NA NA NA NA NA NA NA NA NA NA ...

## Discussion:

The `pols-month` file comprises 822 observations across 9 variables,
providing insights into the count of national politicians affiliated
with the Democratic or Republican parties from years 1947 to 2015. The
`snp` file encompasses 787 observations, featuring 3 variables that
offer insights into Standard & Poor’s stock market index (S&P) ranging
from years 1969 to 2068. Widely recognized as a representative measure
of the overall stock market, these variables provide valuable
information on market trends and performance. The file `unemployment`
contains 816 observations of 3 variables ranging from years 1948 to
2015. The average unemployment rate is 5.83.

For the resulting `df`, it has 822 observations across 11 variables with
years ranging from 1947 to 2015. Variables include:

***gov_gop:*** the number of republican governors on the associated date

***sen_gop:*** the number of republican senators on the associated date

***rep_gop:*** the number of republican representatives on the
associated date

***gov_dem:*** the number of democratic governors on the associated date

***sen_dem:*** the number of democratic senators on the associated date

***rep_dem:*** the number of democratic representatives on the
associated date

***president:***: the party affiliation of the politician

***close:*** the closing values of the S&P stock index on the associated
date. The average closing rate is 643.34.

***percentage:*** the percentage of unemployment.The average
unemployment rate is 5.83.

# Problem 2

Clean `Mr. Trash Wheel`.

``` r
mr_df=
  readxl::read_excel("data/202309 Trash Wheel Collection Data.xlsx",sheet=1,range="A2:N587")|>
  janitor::clean_names()|>
  filter(!is.na(dumpster))|>
  mutate(homes_powered=weight_tons*500/30,
         trash_wheel="mr",
         year=as.numeric(year))
```

Clean `Professor Trash Wheel`.

``` r
prof_df=
  readxl::read_excel("data/202309 Trash Wheel Collection Data.xlsx",sheet=2,range="A2:M109")|>
  janitor::clean_names()|>
  filter(!is.na(dumpster))|>
  mutate(homes_powered=weight_tons*500/30,
         trash_wheel="professor")
```

Clean `Gwynnda Trash Wheel`

``` r
gwy_df=
  readxl::read_excel("data/202309 Trash Wheel Collection Data.xlsx",sheet=4,range="A2:L159")|>
  janitor::clean_names()|>
  filter(!is.na(dumpster))|>
  mutate(homes_powered=weight_tons*500/30,
         trash_wheel="gwynnda")
```

Then combine these datasets.

``` r
combined_df=bind_rows(mr_df,prof_df,gwy_df)|>
  mutate(homes_powered=round(homes_powered,digits=0))
str(combined_df)
```

    ## tibble [845 × 15] (S3: tbl_df/tbl/data.frame)
    ##  $ dumpster          : num [1:845] 1 2 3 4 5 6 7 8 9 10 ...
    ##  $ month             : chr [1:845] "May" "May" "May" "May" ...
    ##  $ year              : num [1:845] 2014 2014 2014 2014 2014 ...
    ##  $ date              : POSIXct[1:845], format: "2014-05-16" "2014-05-16" ...
    ##  $ weight_tons       : num [1:845] 4.31 2.74 3.45 3.1 4.06 2.71 1.91 3.7 2.52 3.76 ...
    ##  $ volume_cubic_yards: num [1:845] 18 13 15 15 18 13 8 16 14 18 ...
    ##  $ plastic_bottles   : num [1:845] 1450 1120 2450 2380 980 1430 910 3580 2400 1340 ...
    ##  $ polystyrene       : num [1:845] 1820 1030 3100 2730 870 2140 1090 4310 2790 1730 ...
    ##  $ cigarette_butts   : num [1:845] 126000 91000 105000 100000 120000 90000 56000 112000 98000 130000 ...
    ##  $ glass_bottles     : num [1:845] 72 42 50 52 72 46 32 58 49 75 ...
    ##  $ plastic_bags      : num [1:845] 584 496 1080 896 368 ...
    ##  $ wrappers          : num [1:845] 1162 874 2032 1971 753 ...
    ##  $ sports_balls      : num [1:845] 7.2 5.2 6 6 7.2 5.2 3.2 6.4 5.6 7.2 ...
    ##  $ homes_powered     : num [1:845] 72 46 58 52 68 45 32 62 42 63 ...
    ##  $ trash_wheel       : chr [1:845] "mr" "mr" "mr" "mr" ...

## Description:

The `combined_df` comprises 845 observations across 15 variables,
ranging from years 2014 to 2023. The combined dataset includes
information on the dumpter number, date of collection, amount of total
litter and litter type as well as three different trash wheel(Mr. Trash
Wheel, Professor Trash wheel, Gwynnda Trash Wheel). The total weight of
trash collected by Professor Trash Wheel is 216.26 tons. The total
number of cigarette butts collected by Gwynnda in July of 2021 is
1.63^{4}.

# Problem 3

Import `MCI baseline` data, and skip the first row of description. I use
`janitor` function to standardize column names. Then convert `sex`
variable and `apoe4` variable to factor variable, and convert
`age at onset` variable to numeric variable.

``` r
baseline_df=
  read_csv("data/MCI_baseline.csv",skip=1)|>
  janitor::clean_names()|>
  mutate(
    sex=as.factor(sex),
    apoe4=as.factor(apoe4),
    age_at_onset=as.numeric(age_at_onset)
  )|>
  filter(!is.na(age_at_onset))
```

    ## Rows: 483 Columns: 6
    ## ── Column specification ────────────────────────────────────────────────────────
    ## Delimiter: ","
    ## chr (1): Age at onset
    ## dbl (5): ID, Current Age, Sex, Education, apoe4
    ## 
    ## ℹ Use `spec()` to retrieve the full column specification for this data.
    ## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.

    ## Warning: There was 1 warning in `mutate()`.
    ## ℹ In argument: `age_at_onset = as.numeric(age_at_onset)`.
    ## Caused by warning:
    ## ! NAs introduced by coercion

## Discussion

The `MCI baseline` data comprises 97 observations across 6 variables.
The dataset contains information of current age, sex, year of education,
APOE4 carrier and age at onset of MCI. For participants who develop MCI,
their average baseline age is 65.61, and their current age ranges from
58.1 to 71.6. Altogether, 483 participates are recruited. Among them, 97
develop MCI. In the study, 65.22% women are APOE4 carriers.

Next, clean `MCI amyloid` data, and skip the first row of description. I
use `janitor` function to standardize column names. Then, turn all
columns to numeric variable.

``` r
amyloid_df=
  read_csv("data/mci_amyloid.csv",skip=1,na=c('Na',"NA"))|>
  janitor::clean_names()|>
  pivot_longer(
    baseline:time_8,
    names_to="time",
    values_to="42/40 ratio"
  )|>
  rename(id=study_id)|>
  as.data.frame(lapply(amyloid_df, as.numeric))
```

    ## Rows: 487 Columns: 6
    ## ── Column specification ────────────────────────────────────────────────────────
    ## Delimiter: ","
    ## dbl (6): Study ID, Baseline, Time 2, Time 4, Time 6, Time 8
    ## 
    ## ℹ Use `spec()` to retrieve the full column specification for this data.
    ## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.

## Discussion

The `MCI amyloid` data comprises 2435 observations across 3 variables.
The dataset keeps record of biomarker Amyloid β42/40 ratio in different
time.

Time to merge this two datasets.

``` r
merged_df=merge(baseline_df,amyloid_df,by="id",all=FALSE)
write_csv(merged_df,"data/merged_df.csv")
str(merged_df)
```

    ## 'data.frame':    470 obs. of  8 variables:
    ##  $ id          : num  3 3 3 3 3 5 5 5 5 5 ...
    ##  $ current_age : num  62.5 62.5 62.5 62.5 62.5 66 66 66 66 66 ...
    ##  $ sex         : Factor w/ 2 levels "0","1": 2 2 2 2 2 2 2 2 2 2 ...
    ##  $ education   : num  16 16 16 16 16 16 16 16 16 16 ...
    ##  $ apoe4       : Factor w/ 2 levels "0","1": 2 2 2 2 2 1 1 1 1 1 ...
    ##  $ age_at_onset: num  66.8 66.8 66.8 66.8 66.8 68.7 68.7 68.7 68.7 68.7 ...
    ##  $ time        : chr  "time_4" "time_8" "time_2" "baseline" ...
    ##  $ 42/40 ratio : num  0.106 0.106 0.109 0.106 NA ...
